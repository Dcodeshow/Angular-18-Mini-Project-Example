<div class="row">
  <div class="col-lg-12 m-0">
    <div class="card p-4">
      <!-- Add Member Inputs -->
      <form [formGroup]="EmpRelatives" (ngSubmit)="addRelatives()">
        <div class="row g-2 mb-3">
          <!-- Name -->
          <div class="col-md-4">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Name</mat-label>
              <input
                matInput
                placeholder="Enter Name"
                formControlName="relName"
              />
              <mat-error
                *ngIf="
                  EmpRelatives.get('relName')?.invalid &&
                  EmpRelatives.get('relName')?.touched
                "
              >
                Field is required
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Relation -->
          <div class="col-md-4">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Relation</mat-label>
              <input
                matInput
                placeholder="Relation"
                formControlName="relRelation"
              />
              <mat-error
                *ngIf="
                  EmpRelatives.get('relRelation')?.invalid &&
                  EmpRelatives.get('relRelation')?.touched
                "
              >
                Field is required
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Age -->
          <div class="col-md-4">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Age</mat-label>
              <input
                matInput
                type="number"
                placeholder="Age"
                formControlName="relAge"
              />
              <mat-error
                *ngIf="
                  EmpRelatives.get('relAge')?.invalid &&
                  EmpRelatives.get('relAge')?.touched
                "
              >
                Required
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Relation -->
          <div class="col-md-4" *ngIf="EmpRelatives.get('location')">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Location</mat-label>
              <input
                matInput
                placeholder="Location"
                formControlName="location"
              />
              <mat-error
                *ngIf="
                  EmpRelatives.get('location')?.invalid &&
                  EmpRelatives.get('location')?.touched
                "
              >
                Field is required
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Button -->
          <div class="col-md-100 d-flex align-items-end">
            <button
              mat-raised-button
              color="matcolor"
              type="submit"
              class="me-2"
            >
              <div
                *ngIf="isAPICallingInProgress"
                class="spinner-border spinner-border-sm"
                role="status"
              >
                <span class="visually-hidden">Loading...</span>
              </div>
              Add
            </button>
            <button
              mat-raised-button
              color="primary"
              type="button"
              (click)="addLocation()"
            >
              Add Location
            </button>
          </div>
        </div>
      </form>

      <!-- Table -->
      <table class="table table-bordered align-middle">
        <thead class="table-light">
          <tr>
            <th>Name</th>
            <th>Relation</th>
            <th>Age</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngIf="!isTableloaded">
            <tr *ngFor="let member of familyList; let i = index">
              <td>{{ member.relName | titlecase }}</td>
              <td>{{ member.relRelation | titlecase }}</td>
              <td>{{ member.relAge }}</td>
              <td>
                <button class="btn btn-danger" (click)="openDialog(member)">
                  Delete
                </button>
              </td>
            </tr>
          </ng-container>
          <ng-container *ngIf="isTableloaded">
            <tr>
              <td colspan="3" class="text-center">
                <div class="spinner-border text-success" role="status">
                  <span class="visually-hidden">Loading...</span>
                </div>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>

<ng-template class="confirm-dailog" #confirmDailog>
  <h2 mat-dialog-title>⚠️ Confirm Delete</h2>
  <mat-dialog-content>Are you sure you want to delete?</mat-dialog-content>
  <mat-dialog-actions align="center">
    <button mat-stroked-button color="primary" mat-dialog-close="false">
      Cancel
    </button>
    <button mat-raised-button color="warn" mat-dialog-close="true">
      Delete
    </button>
  </mat-dialog-actions>
</ng-template>

<!-- Success Dialog -->
<ng-template #successDialog>
  <div class="success-content">✅ Delete Successful!</div>
</ng-template>
